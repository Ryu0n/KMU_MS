# 선형시스템의 해 구하기 (가우스 소거법 - Gauss Elimination)
## 선형시스템의 해
선형시스템의 해의 경우는 크게 3가지로 분류된다.  
1. 해가 하나일 경우 (unique solution)  
   eg) 3x = 6
2. 해가 존재하지 않는 경우 (no solution)  
   eg) 0x = 6
3. 해가 여러개인 경 (infinitely many solutions)  
   eg) 0x = 0
   
2번과 3번같이 a가 0일 경우 **특이**(**singular**)하다고 표현한다. a에 대한 역수가 존재하지 않기 때문이다.  

해가 존재하는 경우는 linear system 이  **consistent** 하다 표현하고, 존재하지 않으면 **inconsistent** 하다고 표현한다.

행렬도 위와 마찬가지이다.  
```
해가 하나인 경우(consistant)

|1  3| |x1|   |2|
|    | |  | = | |
|-2 1| |x2|   |3|

해가 없는 경우(inconsistent) & 역행렬이 존재하지 않음(singular)

|1 3| |x1|   |2|
|   | |  | = | |
|2 6| |x2|   |5|

해가 여러개인 경우(consistant) & 역행렬이 존재하지 않음(singular)

|1 3| |x1|   |2|
|   | |  | = | |
|2 6| |x2|   |4|
```

## 가우스 소거법 (Gauss Elimination)
가우스 소거법은 m x n linear system 의 해를 구하는 대표적인 방법이다. 가우스 소거법은 다음 두 단계로 진행된다.
1. 전방소거법 (Forward elimination) : 주어진 선형시스템을 아래로 갈수록 더 단순한 형태의 선형방정식을 가지도록 변형한다.  

우리가 선형시스템에서 해를 바로 구하지 못하는 이유는 계수행렬의 수가 너무 많기 때문이다. 그래서 그 수를 Forward 방향으로 줄이는 것이 목표이다.
Forward 방향은 기본적으로 **계수행렬의 위에서 아래방향, 왼쪽에서 오른쪽 방향**으로 정의한다.
그럼 다음과 같은 형태의 linear system 을 볼 수 있을 것이다.  
```
|?1 ?2 ?3| |x1|   |?a|
|0  ?4 ?5| |x2| = |?b|
|0   0 ?6| |x3|   |?c|
```
전방소거법을 마친 상태에서 가장 아래의 선형방정식을 확인해보면 ?6 * x3 = ?c 형태의 아주 간단한 방정식이 되어있을 것이다.


2. 후방대입법 (Back-substitution) : 아래서부터 위로 미지수를 실제 값으로 대체한다.
```
|?1 ?2 ?3| |x1|   |?a|
|0  ?4 ?5| |x2| = |?b|
|0   0 ?6| |x3|   |?c|
```
(?1 ~ ?6, ?a ~ ?c 는 전부 상수라 가정)  
다음과 같은 linear system 이 있을 때 최하단의 linear equation 을 통해 x3를 구하는 것은 아주 쉬운 일이다.
그 위의 linear equation 에 x3를 대입하면 x2 또한 쉽게 구할 수 있다. 마찬가지로 최상단의
linear equation 에 앞서 구한 x2와 x3를 대입하면 x1도 쉽게 구할 수 있다.

### 기본행연산 (ERO - Elementary Row Operations)
전방소거법은 **기본행연산**을 기반으로 하고 있다.  

<img width="512" alt="image" src="https://user-images.githubusercontent.com/32003817/110230040-37317a00-7f51-11eb-9093-d55302039a53.png">  

1. Interchange (교환)
2. Scaling (스케일링)
3. Replacement (치환)

### 전방소거법 예시

```
|1 2  1| |x1|   | 1| -> r1
|1 2  3| |x2| = | 3| -> r2
|2 3 -1| |x3|   |-3| -> r3
```
다음과 같은 linear system이 있다고 가정할 때, 전방소거법을 먼저 진행해보자.
우선 우리는 **주대각이 1이고, 그 아래의 수는 0**으로 바꾸어 역삼각형 형태의 행렬을 만드는 것이 목적이다.
2번 행(r2)에서 1번 행(r1)을 빼면 다음과 같은 형태로 변할 것이다.

```
<< R12(-1) :  r2 = r2 - r1 >>

|1 2  1| |x1|   | 1|
|0 0  2| |x2| = | 2|
|2 3 -1| |x3|   |-3|
```
이로써 주대각선의 첫 번째 요소에 해당하는 (1, 1)요소의 값을 1로, 그 밑의 (1, 2)요소의 값을 0으로 바꾸었다.
(1, 3)요소의 값을 0으로 바꿀 차례이다.
r3에서 r1에 2를 곱하여 빼면 (1, 3)요소가 0으로 소거될 것이다.

```
<< R13(-2) : r3 = r3 - 2*r1 >>

|1  2  1| |x1|   | 1|
|0  0  2| |x2| = | 2|
|0 -1 -3| |x3|   |-5|
```
그러나 지금 주대각선의 두 번째 요소인 (1, 2)요소가 0이므로 값을 존재하게 하기 위해 r2와 r3의 자리를 바꾼다.

```
<< R23 : r2 <-> r3 >>

|1  2  1| |x1|   | 1|
|0 -1 -3| |x2| = |-5|
|0  0  2| |x3|   | 2|
```
주대각선의 두 번째 요소(1, 2)를 1로 맞추기 위해 r2에 -1을 곱한다.

```
<< R2(-1) : r2 = r2 * (-1) >>

|1  2  1| |x1|   |1|
|0  1  3| |x2| = |5|
|0  0  2| |x3|   |2|
```
주대각선의 세 번째 요소(1, 3)를 1로 맞추기 위해 r3에 (1/2)를 곱한다.

```
<< R3(1/2) : r3 = r3 * (1/2) >>

|1  2  1| |x1|   |1|
|0  1  3| |x2| = |5|
|0  0  1| |x3|   |1|
```
계수행렬(row vector)이 상삼각형태(upper triangular form)로 변형된 모습다. 

### 후방대입법 예시
```
|1  2  1| |x1|   |1|
|0  1  3| |x2| = |5|
|0  0  1| |x3|   |1|
```
전방소거법을 통해 다음과 같은 형태의 계수행렬(row vector)을 만들었다. 이제 unknown에 실제 상수를 대입하는 과정이다.
r3를 보면 x3 = 1인 것을 바로 알 수 있기 때문에 미지수벡터(column vector)의 x3에 대입한다.  

```
|1  2  1| |x1|   |1|
|0  1  3| |x2| = |5|
|0  0  1| | 1|   |1|
```
r2 = x2 + 3 = 5 이므로 x2는 2임을 바로 알 수 있다.  

```
|1  2  1| |x1|   |1|
|0  1  3| | 2| = |5|
|0  0  1| | 1|   |1|
```
r3 = x1 + 4 + 1 = 1 이므로 x1은 -4임을 바로 알 수 있다.

```
|1  2  1| |-4|   |1|
|0  1  3| | 2| = |5|
|0  0  1| | 1|   |1|
```
최종적으로 column vector를 구한 상태이다.  

### 전방소거법의 가치
1. 주어진 linear system 을 가장 풀기 쉬운 형태로 변형해준다.
2. 주어진 linear system 의 rank 를 알려준다.
3. linear system 에 해가 있는지 (consistent) 없는지 (inconsistent) 알려준다.

#### Rank
전방소거법(forward elimination)을 마친 row vector 가 0으로 이루어진 row를 제외한 row의 갯수이다.
이것이 필요한 이유는?  

예를 들어보자.
```
rank = 2)

| 1 3| |x1|   |2|  forward elimination  | 1 3| |x1|   |2|
|    | |  | = | |  -------------------> |    | |  | = | |
|-2 1| |x2|   |3|                       | 0 1| |x2|   |1|
```

```
rank = 1)

|1 3| |x1|   |2|  forward elimination  | 1 3| |x1|   |2|
|   | |  | = | |  -------------------> |    | |  | = | |
|2 6| |x2|   |4|                       | 0 0| |x2|   |0|
```
두 linear system 모두 2개의 linear equation 과 2개의 unknown 이 존재하기 때문에
2 by 2 linear system 이다. 하지만 두 번째 linear system 을 forward elimination 한
결과 첫 번째 linear equation 을 두 배하면 두 번째 linear equation 이 나오므로 **실질적으로 
하나의 linear equation 이 존재**하는 것이나 다름없다. 이 경우 rank 가 1이라고 정의한 것이다.

#### Notice Consistent / Inconsistent
```
Consistent)

|1 3| |x1|   |2|  forward elimination  | 1 3| |x1|   |2|
|   | |  | = | |  -------------------> |    | |  | = | |
|2 6| |x2|   |4|                       | 0 0| |x2|   |0|
```
forward elimination 을 마친 마치막 linear equation 을 보면
0x1 + 0x2 = 0 인 것을 알 수 있다. 이는 어떠한 x1, x2를 대입하여도
만족하다는 의미이기 때문에 해가 무수히 많을 뿐 존재한다는 것을 알 수 있다.

```
Inconsistent)

|1 3| |x1|   |2|  forward elimination  | 1 3| |x1|   |2|
|   | |  | = | |  -------------------> |    | |  | = | |
|2 6| |x2|   |5|                       | 0 0| |x2|   |1|
```
반면 forward elimination 을 마친 마치막 linear equation 을 보면
0x1 + 0x2 = 1 다. 이는 어떠한 x1, x2를 대입하여도
만족할 수 없는 의미이기 때문에 해가 존재하지 않는다는 것을 알 수 있다.  