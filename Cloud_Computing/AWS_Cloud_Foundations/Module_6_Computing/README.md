# 컴퓨팅
## 컴퓨팅 서비스 개요
![img.png](img.png)  
AWS는 이 모듈에서 다루는 많은 컴퓨팅 서비스를 제공한다.  
* Amazon Elastic Compute Cloud (EC2)  
크기 조정이 가능한 가상 머신을 제공한다.  
  
* Amazon EC2 Auto Scaling  
EC2 인스턴스를 자동으로 시작하거나 종료하는 조건을 정의할 수 있도록 하여 애플리케이션 가용성을 지원한다.

* Amazon Elastic Container Registry (ECR)  
Docker 이미지를 저장하고 검색하는 데 사용된다.  
  
* Amazon Elastic Container Service (ECS)  
Docker를 지원하는 컨테이너 오케스트레이션 서비스이다.  
  
* VMware Cloud on AWS  
맞춤형 하드웨어 없이 하이브리드 클라우드를 프로비저닝할 수 있다.  
  
* AWS Elastic Beanstalk  
감편하게 웹 애플리케이션을 실행하고 관리할 수 있는 서비스
  
* AWS Lambda  
서버리스 컴퓨팅 솔루션으로 사용한 컴퓨팅 시간에 대해서만 비용을 지불한다.
  
* Amazon Elastic Kubernetes Service (EKS)  
AWS 에서 관리형 Kubernetes를 실행할 수 있다.
  
* Amazon Lightsail  
애플리케이션 또는 웹 사이트를 구축할 수 있는 간편한 서비스를 제공한다.

* AWS Batch  
규모에 관계없이 배치 작업을 실행할 수 있는 도구를 제공
  
* AWS Fargate  
서버 또는 클러스터를 관리해야 하는 부담이 적은 컨테이너를 실행하는 서비스를 제공  
  
* AWS Outpost  
온프레미스 데이터 센터에서 엄선된 AWS 서비스를 실행할 수 있도록 지원
  
* AWS Serverless Application  
Repository를 사용하면 서버리스 애플리케이션을 검색, 배포 및 게시할 수 있다.  
  
## 컴퓨팅 서비스 분류
![img_1.png](img_1.png)  
컴퓨팅 서비스는 크게 가상 머신을 제공하는 컴퓨팅 서비스인 **서비스형 인프라**, **서버리스 컴퓨팅**, **컨테이너 기반 컴퓨팅**, 웹 애플리케이션을 위한 **서비스형 플랫폼**으로 정의되는 4가지 범주중 하나에 포함된다.
* 서비스형 인프라  
e.g) Amazon EC2  
  이 범주의 서비스는 유연성을 제공하며 서버 관리 작업의 많은 부분을 사용자가 맡아야 한다.
  운영체제는 물론 실행하는 서버의 크기 및 리소스 기능도 사용자가 선택한다.  
  
  
* 서버리스 컴퓨팅  
e.g) AWS Lambda (관리가 전혀 필요하지 않은 컴퓨팅 플랫폼)  
  AWS Lambda를 사용하면 서버를 프로비저닝하거나 관리하지 않고도 코드를 실행할 수 있다.
  사용한 컴퓨팅 시간ㅇ네 대한 요금만 지불한다. 서버리스 컴퓨팅의 인기가 높아지는 이유는 **클라우드 네이티브 아키텍처를 지원하기** 때문이다.
  클라우드 네이티브 아키텍처에서는 동일한 워크로드의 실행을 보장하기 위해 서비스를 상시 실행하는 것보다 저렴한 비용으로 대규모 확장 및 축소를 수행할 수 있다.  
  
* 컨테이너 기반 컴퓨팅  
e.g) Amazon Elastic Container Service, Amazon Elastic Kubernetes Service, AWS Fargate, Amazon Elastic Container Registry  
  컨테이너는 프로비저닝 프로세스에서 **운영 체제를 추상화**하기 때문에 가상머신보다 더 빠르게 프로비저닝된다.  
  
* 서비스형 플랫폼  
e.g) AWS Elastic Beanstalk (웹 애플리케이션을 위한)  
  AWS Elastic Beanstalk는 필요한 모든 애플리케이션 서비스를 제공하므로 배포가 가속화된다. 
  OS, 애플리케이션 서버 및 기타 인프라 구성 요소를 AWS가 관리하므로 사용자는 애플리케이션 코드 개발에 집중할 수 있다.  
  
## 최적의 컴퓨팅 서비스 선택
![img_2.png](img_2.png)  
단일 컴퓨팅 솔루션으로 시작한 다음 애플리케이션 설계의 사용량 패턴 또는 변경에 따라 설계를 완전히 변경할 수도 있다.

## Amazon EC2
![img_3.png](img_3.png)  
Amazon EC2는 온프레미스 서버에서 실행하는 것과 동일한 애플리케이션을 호스팅할 수 있는 가상머신을 제공한다.
안전하고 크기 조정이 가능한 컴퓨팅 용량을 클라우드에서 사용할 수 있다.  

![img_4.png](img_4.png)  
EC2는 가상머신 템플릿인 AMI (Amazon Machine Image)에서 시작된다. 인스턴스의 인바운드/아웃바운드 트래픽은
보안 그룹을 통해 제어할 수 있다.  

## EC2 인스턴스 고려사항
1. AMI  
   ![img_5.png](img_5.png)
   AMI를 선택하는 것. AMI는 템플릿으로 생각하면 된다.  
   예를 들어 웹 서버로 사용할 인스턴스를 시작할 때 선택하는 AMI는 애플리케이션 서버를 호스팅할 인스턴스를 배포할 때 선택하는 AMI와 다를 수 있다.
   하나의 AMI에서 여러 인스턴스를 시작할 수도 있다.  
   사용예제)  
   ![img_6.png](img_6.png)  
   (캡처 이후) AMI를 생성할 때 Amazon EC2는 인스턴스를 중지하고 루트 볼륨 스냅샷을 생성한 다음 이 스냅샷을 AMI로 등록한다.
   AMI가 등록되면 AMI를 사용하여 동일한 AWS 리전에서 새 인스턴스를 시작할 수 있다.
   
2. 인스턴스 유형  
   ![img_7.png](img_7.png)  
   인스턴스 유형을 선택하는 것.  
   ![img_8.png](img_8.png)  
   인스턴스의 이름은 **패밀리 이름, 세베 번호, 크기**로 구성되어 있다. 이 이름들을 통해 요구사항에 적절한 이름을 선택하면 된다.  
   ![img_9.png](img_9.png)  
   ![img_10.png](img_10.png)  
   워크로드의 CPU, RAM 및 스토리지 요구 사항을 고려하는 것 외에 네트워크 대역폭 요구 사항을 고려하는 것도 중요하다.  
   ex) a1.medium 인스턴스는 초당 최대 10기가비트를 제공하지만, p3dn.24xlarge 인스턴스는 초당 최대 100기가비트를 제공한다.  
   
   다수의 새 인스턴스가 시작되는 경우 Amazon에서는 이러한 인스턴스를 기반 하드웨어에 분산하려고 애쓰며 모두 동일한 하드웨어에 배치하지 않는다.
   그러나 워크로드의 요구사항을 충족하기 위해 상호 의존적인 인스턴스를 배치하는 경우라면 배치 그룹을 사용할 수 있다.  
   예를들어 인스턴스 3개를 모두 동일한 가용영역에 배포하도록 지정하여 인스턴스 간 네트워크 지연 시간을 줄이고 네트워크 처리량을 늘릴수 있다.
   
3. 네트워크 설정 지정  
   ![img_11.png](img_11.png)  
   AMI와 인스턴스 유형을 선택한 후에는 EC2 인스턴스를 배포할 네트워크 위치를 지정해야 한다.
   인스턴스 시작 마법사를 시작하기 전에 **리전**을 선택해야 한다. 리전 내에서 기존 서브넷 또는 기존 VPC에 인스턴스를 배치하도록 지정할 수 있다.
   마법사는 새 VPC를 생성하거나 원하는 경우 새 서브넷을 생성할 수 있는 링크도 제공한다.
   위치를 따로 지정하지 않으면 인스턴스는 기본 VPC에 배치된다. 기본 VPC에서 인스턴스를 시작하는 경우 AWS는 **기본적으로 퍼블릭 IP 주소**를 할당한다.
   기본이 아닌 VPC에서 인스턴스를 시작하는 경우 이 VPC에서 시작된 인스턴스에서 **퍼블릭 IP를 수신할지 여부는 서브넷의 속성에 따라** 결정된다.
   
4. IAM 역할 연결 (선택사항)  
   ![img_12.png](img_12.png)  
   일반적으로 EC2 인스턴스는 다른 AWS 서비스에 대한 API 호출을 수행해야 하는 애플리케이션을 실행하는 데 사용된다.
   이러한 사용 사례를 지원하려면 AWS에서 IAM 역할을 생성하고 EC2 인스턴스에 연결할 수 있다. 
   이 기능이 없으면 애플리케이션에서 다른 AWS 서비스를 호출할 때 사용할 AWS 자격 증명을 EC2 인스턴스에 배치하고 싶을 수 있다.
   **하지만 EC2 인스턴스에 AWS 자격 증명을 저장해서는 안된다.** 대신 IAM 역할을 EC2 인스턴스에 연결한다.  
   **인스턴스 프로파일은 IAM 역할에 대한 컨테이너**이다. 
   AWS Management Console을 사용하여 Amazon EC2의 역할을 생성하는 경우 콘솔이 자동으로 인스턴스 프로파일을 생성하여 해당 역할과 동일한 이름을 부여한다.
   *이미 실행중인 인스턴스에도 역할을 연결할 수 있다.*  
   
5. 사용자 데이터 스크립트 (선택사항)  
   ![img_13.png](img_13.png)  
   EC2 인스턴스를 생성할 때 사용자 데이터를 인스턴스에 전달할 수 있는 옵션을 사용할 수 있다.
   사용자 데이터를 사용하여 인스턴스 시작 시 설치 및 구성 작업을 자동으로 완료할 수 있다. 
   예를 들어 사용자 데이터 스크립트를 실행하여 인스턴스의 운영체제를 패치 및 업데이트하거나 소프트웨어 라이선스 키를 가져와 설치하거나
   추가 소프트웨어를 설치할 수 있다. Windows 인스턴스의 경우 사용자 데이터 스크립트는 명령 프롬프트 창(배치 명령) 또는 Windows PowerShell과 호환되는 형식으로 작성되어야 한다.
   EC2 인스턴스가 생성될 때 부팅 프로세스의 마지막 단계에서 사용자 데이터 스크립트가 실행된다. 기본적으로 사용자 데이터는 **인스턴스가 처음 시작될 때만** 실행된다.
   사용자 데이터 스크립트를 전략적으로 사용하여 구축 및 유지 관리가 필요한 사용자 지정 AMI의 수를 줄일 수 있다.
   
6. 스토리지 지정  
   ![img_14.png](img_14.png)  
   EC2 인스턴스를 시작할 때 스토리지 옵션을 구성할 수 있다. 
   예를 들어 Windows 또는 Linux 같은 게스트 **운영 체제가 설치된 루트 볼륨**의 크기를 구성할 수 있다.
   인스턴스를 시작할 때 추가 **스토리지 볼륨을 연결**할 수도 있다.
   일부 AMI는 기본적으로 2개 이상의 스토리지 볼륨을 시작하여 루트 볼륨과 분리된 스토리지 옵션을 제공하도록 구성된다.  
   스토리지 옵션)
   ![img_15.png](img_15.png)  
   여기서 중요한 점은 인스턴스 스토어는 **휘발성 메모리**라는 점이다. 고로 인스턴스가 중지되면 데이터가 유지되지 않는다.  
   그리고, EFS, S3는 루트 볼륨으로써 사용할 수 없다. (Elastic Block Store, 인스턴스 스토어만이 루트 볼륨으로 사용가능)  
   ![img_16.png](img_16.png)  
   인스턴스 1의 경우에는 중지후 시작할 때, 휘발성 볼륨 1(인스턴스 스토어)이 초기화된다. 하지만 나머지 볼륨들은 유지된다.  
   반면, 인스턴스 2의 경우에는 운영체제가 휘발성 볼륨 2(인스턴스 스토어)에 저장되어 있기 때문에 운영체제가 초기화되어 재시동이 불가능하다.  
   **인스턴스 2와 같이 인스턴스 스토어가 루트 볼륨으로 사용되는 경우 Amazon EC2 API 호출로 중지할 수 없다.** 인스턴스 OS 내에서 종료하거나 오류로 인해 중지된다.
   
## Amazon EC2 비용 최적화
## 컨테이너 서비스
## AWS Lambda
## AWS Elastic Beanstalk